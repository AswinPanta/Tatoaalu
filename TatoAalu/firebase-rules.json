{
  "rules": {
    "leaderboard": {
      ".read": true,
      ".write": "auth != null && (!data.exists() || data.child('timestamp').val() < (now - 60000)) && newData.hasChildren(['name', 'wins', 'timestamp']) && newData.child('name').isString() && newData.child('wins').isNumber() && newData.child('timestamp').isNumber()",
      "$playerId": {
        ".validate": "newData.hasChildren(['name', 'wins', 'timestamp'])",
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50 && newData.val().matches(/^[a-zA-Z0-9\\s\\-_\\.]+$/)"
        },
        "wins": {
          ".validate": "newData.isNumber() && newData.val() >= 0 && newData.val() <= 10000 && newData.val() % 1 === 0"
        },
        "timestamp": {
          ".validate": "newData.isNumber() && newData.val() <= now && newData.val() > (now - 86400000)"
        },
        "$other": {
          ".validate": false
        }
      }
    },
    "rooms": {
      ".read": true,
      ".write": true,
      "$roomId": {
        ".read": true,
        ".write": true,
        ".validate": "newData.hasChildren(['host', 'state', 'createdAt']) && newData.child('host').isString() && newData.child('state').isString() && newData.child('createdAt').isNumber()",
        "host": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
        },
        "state": {
          ".validate": "newData.isString() && (newData.val() == 'WAITING' || newData.val() == 'PLAYING' || newData.val() == 'FINISHED')"
        },
        "createdAt": {
          ".validate": "newData.isNumber() && newData.val() <= now && newData.val() > (now - 86400000)"
        },
        "currentHolder": {
          ".validate": "newData.isNumber() && newData.val() >= 0"
        },
        "gameStartTime": {
          ".validate": "newData.isNumber()"
        },
        "burnTime": {
          ".validate": "newData.isNumber()"
        },
        "players": {
          ".validate": "newData.hasChildren()",
          "$playerId": {
            ".validate": "newData.hasChildren(['name', 'joinedAt']) && newData.child('name').isString() && newData.child('joinedAt').isNumber()",
            "name": {
              ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
            },
            "joinedAt": {
              ".validate": "newData.isNumber() && newData.val() <= now"
            },
            "isHost": {
              ".validate": "newData.isBoolean()"
            },
            "$other": {
              ".validate": false
            }
          }
        },
        "$other": {
          ".validate": false
        }
      }
    },
    "$other": {
      ".read": false,
      ".write": false
    }
  }
}